

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Problem 2 &#8212; PyProblems</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Problem 2 - Answers" href="elec2.html" />
    <link rel="prev" title="Problem 1 - Answers" href="elec1.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">PyProblems</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mechanics.html">
   Mechanics
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="electrostatics.html">
   Electrostatics
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="elec1Q.html">
     Problem 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="elec1.html">
     Problem 1 - Answers
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Problem 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="elec2.html">
     Problem 2 - Answers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="magnetism.html">
   Magnetism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vibrations.html">
   Vibrations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="relativity.html">
   Relativity
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/elec2Q.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   Background
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#physics">
     Physics
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#electric-field">
       Electric Field
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computational-methods">
     Computational Methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scipy-integration-adapted-from-week-1">
       SciPy Integration (Adapted from Week 1)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#your-task">
   Your Task
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#configurations">
     Configurations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-simple-configuration">
       A Simple Configuration
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#expanding-upon-the-simple-configuration">
       Expanding upon the Simple Configuration
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-more-complicated-case">
       A More Complicated Case
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-hints">
     Coding Hints
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#writing-a-function-to-calculate-the-electric-field">
       Writing a function to calculate the electric field
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="problem-2">
<h1>Problem 2<a class="headerlink" href="#problem-2" title="Permalink to this headline">¶</a></h1>
<p>This problem revolves around visualising electric field lines using the same techniques used last time to calculate particle motion. You will be given the details of several different charge configurations for which to draw the field lines.</p>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<div class="section" id="physics">
<h3>Physics<a class="headerlink" href="#physics" title="Permalink to this headline">¶</a></h3>
<div class="section" id="electric-field">
<h4>Electric Field<a class="headerlink" href="#electric-field" title="Permalink to this headline">¶</a></h4>
<p>As opposed to last problem, we are now interested in the electric field as a result of <em>all</em> the charges in the system. Thus, Coulomb’s law has to be applied to all charges in the system, leading to the following definition of the electric field:</p>
<div class="math notranslate nohighlight">
\[ \mathbf{E} = \sum_{i} k_e \frac{q_i}{|\mathbf{r}_{i}|^2} \mathbf{\hat{r}}_{i} \]</div>
<p>from the definition of the force written in vector form, with <span class="math notranslate nohighlight">\(r_{i}\)</span> being the vector from the point of interest to <span class="math notranslate nohighlight">\(r_i\)</span>.</p>
</div>
</div>
<div class="section" id="computational-methods">
<h3>Computational Methods<a class="headerlink" href="#computational-methods" title="Permalink to this headline">¶</a></h3>
<div class="section" id="scipy-integration-adapted-from-week-1">
<h4>SciPy Integration (Adapted from Week 1)<a class="headerlink" href="#scipy-integration-adapted-from-week-1" title="Permalink to this headline">¶</a></h4>
<p>As you learnt previously, using the SciPy <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html">solve_ivp</a> function will yield significantly better results than a first-order explicit Euler scheme.</p>
<p>In order to use this function, you must rewrite your calculation function to adhere to a function signature akin to that below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">int_fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">charges</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Differential equations for the system of point charges.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        t (float): Time.</span>
<span class="sd">        y (numpy.ndarray): Array containing the state variables.</span>
<span class="sd">        charges (numpy.ndarray): (N,) array of charges in C.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        iterable: Rates of change of the state variables.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Your code here ...</span>
</pre></div>
</div>
<p>Note especially that the function <strong>must</strong> take a single float (the ‘time’) as its first parameter, even if the function never uses this parameter.</p>
<p>The function can then be used like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
    <span class="n">partial</span><span class="p">(</span><span class="n">int_fun</span><span class="p">,</span> <span class="n">charges</span><span class="o">=</span><span class="n">charges</span><span class="p">),</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">init_state</span><span class="p">,</span>
    <span class="n">t_eval</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># The solutions at different times are contained in sol.y</span>
</pre></div>
</div>
<p>You might have to set the <code class="docutils literal notranslate"><span class="pre">rtol</span></code> parameter to a low number like <code class="docutils literal notranslate"><span class="pre">1e-7</span></code> to achieve realistic results!</p>
<p>As opposed to the first week, this week you might consider using the <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code> function to integrate <em>along a field line</em>. Also note that for this problem, you do <strong>not</strong> need to consider any masses!</p>
</div>
</div>
</div>
<div class="section" id="your-task">
<h2>Your Task<a class="headerlink" href="#your-task" title="Permalink to this headline">¶</a></h2>
<p>You will have to plot field lines for the charge configurations shown below. These will have to be plotted including arrows to indicate the direction of the field. The charge of the different charges should also be apparent.</p>
<p>The range of integration should be large enough to ensure that field lines terminate at charges whenever possible.</p>
<div class="section" id="configurations">
<h3>Configurations<a class="headerlink" href="#configurations" title="Permalink to this headline">¶</a></h3>
<p>Draw field lines for the following scenarios (all positions have units of metres, and charges are given in coulombs):</p>
<div class="section" id="a-simple-configuration">
<h4>A Simple Configuration<a class="headerlink" href="#a-simple-configuration" title="Permalink to this headline">¶</a></h4>
<p>This simple case will depict field lines from two charges at positions (-1, 0) and (1, 0) with charges 1 and -1 respectively.</p>
</div>
<div class="section" id="expanding-upon-the-simple-configuration">
<h4>Expanding upon the Simple Configuration<a class="headerlink" href="#expanding-upon-the-simple-configuration" title="Permalink to this headline">¶</a></h4>
<p>This problem is similar to the one above, in that all the charge are of magnitude 1. The top dipole is a mirrored version of the previous two charges. The charges in this example are positioned at (1, 1), (1, -1), (-1, -1), and (-1, 1) with charges 1, -1, 1, and -1 respectively.</p>
</div>
<div class="section" id="a-more-complicated-case">
<h4>A More Complicated Case<a class="headerlink" href="#a-more-complicated-case" title="Permalink to this headline">¶</a></h4>
<p>Here, 4 charges are placed at the vertices of a square, ie. at (1, 1), (1, -1), (-1, -1), and (-1, 1). Their positive charges are all of magnitude 1.</p>
<p>Another charge is placed in the centre of the square at (0, 0), with charge -2.</p>
</div>
</div>
<div class="section" id="coding-hints">
<h3>Coding Hints<a class="headerlink" href="#coding-hints" title="Permalink to this headline">¶</a></h3>
<div class="section" id="writing-a-function-to-calculate-the-electric-field">
<h4>Writing a function to calculate the electric field<a class="headerlink" href="#writing-a-function-to-calculate-the-electric-field" title="Permalink to this headline">¶</a></h4>
<p>Since the electric field is something that we are trying to visualise, it makes sense to write a function to calculate it. For this purpose, you might be able to re-use the function from last week’s question.</p>
<p>While the exact implementation is up to you, the function could look something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">E</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Electric field.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (float): X position(s).</span>
<span class="sd">        y (float): Y position(s).</span>
<span class="sd">        q (float): Charge(s).</span>
<span class="sd">        r (iterable of float): (x, y) position(s) of the point charge(s). If an array is given,</span>
<span class="sd">            it should be a (2, N) array where N is the number of point charges.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Electric field vectors at every point in `x` and `y`. The shape of</span>
<span class="sd">        this array is the same shape as `x` and `y` with an added initial dimension.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Your code here ...</span>
</pre></div>
</div>
<p>While you could write a function to calculate the electric field from a single point charge, it makes sense to vectorise this function so that it accepts multiple charges. Both methods should yield the same result, since the individual electric fields from multiple charges may be added together to yield the combined field.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="elec1.html" title="previous page">Problem 1 - Answers</a>
    <a class='right-next' id="next-link" href="elec2.html" title="next page">Problem 2 - Answers</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Imperial College Physics Department<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>